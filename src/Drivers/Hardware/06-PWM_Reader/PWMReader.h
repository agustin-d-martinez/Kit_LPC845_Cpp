/*******************************************************************************************************************************//**
 *
 * @file		PWMReader.h
 * @brief		Pata que lee tamaños de pulsos de entrada
 * @details
 *
 * @date		22 jun. 2022
 * @version		1.0
 * @author     	Técnico. Martinez Agustin (masteragus365@gmail.com)
 *
 **********************************************************************************************************************************/
/***********************************************************************************************************************************
 *** MODULO
 **********************************************************************************************************************************/
#ifndef PWM_READER_H_
#define PWM_READER_H_
/** \addtogroup Drivers
 *  @{
 */
/***********************************************************************************************************************************
 *** INCLUDES GLOBALES
 **********************************************************************************************************************************/
#include <Drivers/Perifericos/09-MultiRateTimer/MRThandler.h>
#include <Perifericos/03-PinInterrupt/Pininterrupt.h>
/***********************************************************************************************************************************
 *** DEFINES GLOBALES
 **********************************************************************************************************************************/

/***********************************************************************************************************************************
 *** MACROS GLOBALES
 **********************************************************************************************************************************/

/***********************************************************************************************************************************
 *** TIPO DE DATOS GLOBALES
 **********************************************************************************************************************************/

/***********************************************************************************************************************************
 *** VARIABLES GLOBALES
 **********************************************************************************************************************************/

/***********************************************************************************************************************************
 *** IMPLANTACION DE LA CLASE
 **********************************************************************************************************************************/
/**
 * \class PWM_Reader
 * \brief Clase del objeto PWM_Reader
 *
 *	Lee ancho de señal de una entrada en milisegundos.
 *	Solo lee pulsos completos. Si se queda en 0, no lo leerá hasta volver a 1.
 *  Lectura:
 *  __________________				 _____________________________
 *  |    			 |				 |
 *  |    			 |				 |
 *  |  	    	 	 |_______________|
 *
 *  |----m_pulse_on---|				 |----m_pulse_on---------------
 *  */
class PWM_Reader : protected PinInterrupt , protected MRThandler
{
	private:
		uint32_t m_pulse_on;	/**< Buffer de tiempo on*/

	public:
					PWM_Reader( port_t puerto , uint8_t bit , mode_t modo ,
							activity_t activity , MRT_timer_channels timer_channel );
		void 		Initialize( void );
		uint32_t 	GetPulseOn( void ) const;
		void 		Off( void );
		void 		On( void );
		virtual 	~PWM_Reader(){};		/**< Destructor por defecto */
	protected:
		void 		GpioHandler( void ) override;
};

#endif /* PWM_READER_H_ */
/** @}*/
